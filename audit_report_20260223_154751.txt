SHUI SITE AUDIT (local) — Lun 23 fév 2026 15:47:51 CET
Base URL: http://localhost:3000
Node: v20.20.0 | NPM: 10.8.2
Git: f04efe3
============================================================

## A) BASIC HEALTH (home + core pages)

/ -> HTTP 200
/fr -> HTTP 200
/en -> HTTP 200
/community -> HTTP 200
/dashboard -> HTTP 307
/rewards -> HTTP 200
/mint -> HTTP 200
/gallery -> HTTP 200

## B) SECURITY HEADERS (GET /)

HTTP/1.1 200 OK
x-nextjs-cache: MISS
Cache-Control: no-store, must-revalidate
ETag: "nhmb6efwgtazn"
Content-Type: text/html; charset=utf-8
Content-Length: 14671
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5


## B1) KEY HEADERS PRESENT?

CSP: MISSING
X-Frame-Options: MISSING
X-Content-Type-Options: MISSING
Referrer-Policy: MISSING
Permissions-Policy: MISSING
HSTS: MISSING (normal in local http)

## C) CSP SANITY (basic checks)

CSP: MISSING

## D) AUTH ENDPOINTS (no session) + cookie flags

GET /api/auth/me
HTTP/1.1 401 Unauthorized
Content-Security-Policy: default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://plugin.jup.ag; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: ws://localhost:3000; frame-src 'self' https://v2.bubblemaps.io https://plugin.jup.ag https://jup.ag; worker-src 'self' blob:; manifest-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Permissions-Policy: camera=(), microphone=(), geolocation=()
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Cache-Control: no-store
Content-Type: application/json; charset=utf-8
ETag: "14xn1bp1avnc"
Content-Length: 12
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"ok":false}
POST /api/auth/logout
HTTP/1.1 200 OK
Content-Security-Policy: default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://plugin.jup.ag; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: ws://localhost:3000; frame-src 'self' https://v2.bubblemaps.io https://plugin.jup.ag https://jup.ag; worker-src 'self' blob:; manifest-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Permissions-Policy: camera=(), microphone=(), geolocation=()
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Set-Cookie: shui_session=; Path=/; HttpOnly; SameSite=Lax; Max-Age=0
Content-Type: application/json; charset=utf-8
ETag: "w6gfy8q1ypb"
Content-Length: 11
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"ok":true}
## E) API ERROR HYGIENE (expect clean JSON errors, no stack traces)

POST /api/auth/verify (empty body)
HTTP/1.1 403 Forbidden
Content-Security-Policy: default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://plugin.jup.ag; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: ws://localhost:3000; frame-src 'self' https://v2.bubblemaps.io https://plugin.jup.ag https://jup.ag; worker-src 'self' blob:; manifest-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Permissions-Policy: camera=(), microphone=(), geolocation=()
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Cache-Control: no-store, no-cache, must-revalidate, proxy-revalidate
Pragma: no-cache
Expires: 0
Content-Type: application/json; charset=utf-8
ETag: "135plhf0dwmx"
Content-Length: 33
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"ok":false,"error":"Bad Origin"}
POST /api/auth/nonce (empty body)
HTTP/1.1 403 Forbidden
Content-Security-Policy: default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://plugin.jup.ag; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: ws://localhost:3000; frame-src 'self' https://v2.bubblemaps.io https://plugin.jup.ag https://jup.ag; worker-src 'self' blob:; manifest-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Permissions-Policy: camera=(), microphone=(), geolocation=()
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Cache-Control: no-store, no-cache, must-revalidate, proxy-revalidate
Pragma: no-cache
Expires: 0
Content-Type: application/json; charset=utf-8
ETag: "135plhf0dwmx"
Content-Length: 33
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"ok":false,"error":"Bad Origin"}
POST /api/quest/claim (empty body)
HTTP/1.1 403 Forbidden
Content-Security-Policy: default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://plugin.jup.ag; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: ws://localhost:3000; frame-src 'self' https://v2.bubblemaps.io https://plugin.jup.ag https://jup.ag; worker-src 'self' blob:; manifest-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Permissions-Policy: camera=(), microphone=(), geolocation=()
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Content-Type: application/json; charset=utf-8
ETag: "135plhf0dwmx"
Content-Length: 33
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"ok":false,"error":"Bad Origin"}
POST /api/rewards/claim (empty body)
HTTP/1.1 403 Forbidden
Content-Security-Policy: default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://plugin.jup.ag; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: ws://localhost:3000; frame-src 'self' https://v2.bubblemaps.io https://plugin.jup.ag https://jup.ag; worker-src 'self' blob:; manifest-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Permissions-Policy: camera=(), microphone=(), geolocation=()
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Content-Type: application/json; charset=utf-8
ETag: "135plhf0dwmx"
Content-Length: 33
Vary: Accept-Encoding
Date: Mon, 23 Feb 2026 14:47:56 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"ok":false,"error":"Bad Origin"}

## F) CLIENT BUNDLE QUICK LEAK CHECK (dev bundle, best-effort)

Could not find _app chunk URL (dev may inline). Skipping.

## G) NPM AUDIT (snapshot only)

# npm audit report

bn.js  <5.2.3
Severity: moderate
bn.js affected by an infinite loop - https://github.com/advisories/GHSA-378v-28hj-76wf
fix available via `npm audit fix --force`
Will install @solana/wallet-adapter-wallets@0.16.1, which is a breaking change
node_modules/asn1.js/node_modules/bn.js
node_modules/create-ecdh/node_modules/bn.js
node_modules/diffie-hellman/node_modules/bn.js
node_modules/elliptic/node_modules/bn.js
node_modules/miller-rabin/node_modules/bn.js
node_modules/public-encrypt/node_modules/bn.js
node_modules/tiny-secp256k1/node_modules/bn.js
  asn1.js  >=0.4.0
  Depends on vulnerable versions of bn.js
  node_modules/asn1.js
    parse-asn1  *
    Depends on vulnerable versions of asn1.js
    node_modules/parse-asn1
      browserify-sign  >=2.4.0
      Depends on vulnerable versions of elliptic
      Depends on vulnerable versions of parse-asn1
      node_modules/browserify-sign
  create-ecdh  *
  Depends on vulnerable versions of bn.js
  Depends on vulnerable versions of elliptic
  node_modules/create-ecdh
    crypto-browserify  >=3.4.0
    Depends on vulnerable versions of browserify-sign
    Depends on vulnerable versions of create-ecdh
    Depends on vulnerable versions of diffie-hellman
    Depends on vulnerable versions of public-encrypt
    node_modules/@trezor/blockchain-link/node_modules/crypto-browserify
    node_modules/crypto-browserify
      @solana/wallet-adapter-torus  >=0.11.12
      Depends on vulnerable versions of @toruslabs/solana-embed
      Depends on vulnerable versions of crypto-browserify
      node_modules/@solana/wallet-adapter-torus
        @solana/wallet-adapter-wallets  >=0.16.2
        Depends on vulnerable versions of @solana/wallet-adapter-torus
        Depends on vulnerable versions of @solana/wallet-adapter-trezor
        Depends on vulnerable versions of @solana/wallet-adapter-walletconnect
        node_modules/@solana/wallet-adapter-wallets
      @trezor/blockchain-link  >=2.1.0
      Depends on vulnerable versions of @trezor/blockchain-link-types
      Depends on vulnerable versions of @trezor/utxo-lib
      Depends on vulnerable versions of crypto-browserify
      node_modules/@trezor/blockchain-link
        @trezor/connect  *
        Depends on vulnerable versions of @trezor/blockchain-link
        Depends on vulnerable versions of @trezor/blockchain-link-types
        Depends on vulnerable versions of @trezor/utxo-lib
        node_modules/@trezor/connect
          @trezor/connect-web  *
          Depends on vulnerable versions of @trezor/connect
          node_modules/@trezor/connect-web
            @solana/wallet-adapter-trezor  *
            Depends on vulnerable versions of @trezor/connect-web
            node_modules/@solana/wallet-adapter-trezor
  diffie-hellman  >=1.0.1
  Depends on vulnerable versions of bn.js
  Depends on vulnerable versions of miller-rabin
  node_modules/diffie-hellman
  elliptic  *
  Depends on vulnerable versions of bn.js
  node_modules/elliptic
    @toruslabs/eccrypto  <=6.2.0
    Depends on vulnerable versions of elliptic
    node_modules/@toruslabs/eccrypto
      @toruslabs/broadcast-channel  <=12.0.0
      Depends on vulnerable versions of @toruslabs/eccrypto
      Depends on vulnerable versions of @toruslabs/metadata-helpers
      node_modules/@toruslabs/broadcast-channel
        @toruslabs/base-controllers  >=1.6.16
        Depends on vulnerable versions of @toruslabs/broadcast-channel
        node_modules/@toruslabs/base-controllers
          @toruslabs/solana-embed  0.2.0 - 2.1.0
          Depends on vulnerable versions of @toruslabs/base-controllers
          node_modules/@toruslabs/solana-embed
    @toruslabs/metadata-helpers  <=7.0.2
    Depends on vulnerable versions of @toruslabs/eccrypto
    Depends on vulnerable versions of elliptic
    node_modules/@toruslabs/metadata-helpers
    @walletconnect/utils  2.15.0-canary.1 - 2.19.1
    Depends on vulnerable versions of elliptic
    node_modules/@reown/appkit-controllers/node_modules/@walletconnect/utils
    node_modules/@reown/appkit-utils/node_modules/@walletconnect/utils
    node_modules/@reown/appkit/node_modules/@walletconnect/utils
    node_modules/@walletconnect/utils
      @walletconnect/core  2.15.0-canary-1b3068 - 2.19.1
      Depends on vulnerable versions of @walletconnect/utils
      node_modules/@reown/appkit-controllers/node_modules/@walletconnect/core
      node_modules/@reown/appkit-utils/node_modules/@walletconnect/core
      node_modules/@reown/appkit/node_modules/@walletconnect/core
      node_modules/@walletconnect/core
      @walletconnect/sign-client  2.15.0-canary-1b3068 - 2.19.1
      Depends on vulnerable versions of @walletconnect/core
      Depends on vulnerable versions of @walletconnect/utils
      node_modules/@reown/appkit-controllers/node_modules/@walletconnect/sign-client
      node_modules/@reown/appkit-utils/node_modules/@walletconnect/sign-client
      node_modules/@reown/appkit/node_modules/@walletconnect/sign-client
      node_modules/@walletconnect/sign-client
      @walletconnect/solana-adapter  >=0.0.6
      Depends on vulnerable versions of @reown/appkit
      Depends on vulnerable versions of @walletconnect/universal-provider
      Depends on vulnerable versions of @walletconnect/utils
      node_modules/@walletconnect/solana-adapter
        @solana/wallet-adapter-walletconnect  >=0.1.18
        Depends on vulnerable versions of @walletconnect/solana-adapter
        node_modules/@solana/wallet-adapter-walletconnect
      @walletconnect/universal-provider  2.15.0-canary-1b3068 - 2.19.1
      Depends on vulnerable versions of @walletconnect/sign-client
      Depends on vulnerable versions of @walletconnect/utils
      Depends on vulnerable versions of lodash
      node_modules/@reown/appkit-controllers/node_modules/@walletconnect/universal-provider
      node_modules/@reown/appkit-utils/node_modules/@walletconnect/universal-provider
      node_modules/@reown/appkit/node_modules/@walletconnect/universal-provider
      node_modules/@walletconnect/universal-provider
        @reown/appkit  <=1.7.3-fd380eb099c043db8c203f943692af94e8b00f5b.0

## H) MANUAL REAL-LIFE CHECKLIST (you verify in browser)

- ✅ Wallet connect: Connect button works, disconnect works, no console errors.
- ✅ Login security: login uses signMessage (NOT a transaction).
- ✅ No secrets in client: no SESSION_SECRET or server tokens visible in JS bundle.
- ✅ CSP blocks iframe embedding (frame-ancestors none).
- ✅ /dashboard is protected: without cookie session -> redirect away.
- ✅ API errors are clean JSON, no stack traces.

DONE. Report file: audit_report_20260223_154751.txt
